# ğŸ§¾ ä¸€.ç”¨æˆ·è®¤è¯æ¨¡å— API æ–‡æ¡£

æœ¬æ¨¡å—æä¾›åŸºç¡€çš„ç”¨æˆ·ç™»å½•ä¸æ³¨å†ŒåŠŸèƒ½ï¼Œé‡‡ç”¨ RESTful API è®¾è®¡ã€‚

---

## ğŸŸ¦ 1.ç”¨æˆ·ç™»å½•

- **URL**: `/api/session`
- **æ–¹æ³•**: `POST`
- **æè¿°**: ç”¨æˆ·ç™»å½•æ¥å£ï¼Œæ ¹æ®æ‰‹æœºå·ï¼ˆå§“åï¼‰å’Œå¯†ç è¿›è¡ŒéªŒè¯ï¼ŒæˆåŠŸåè¿”å›ç”¨æˆ·ä¿¡æ¯åŠæƒé™è§’è‰²ã€‚

### ğŸ“¥ è¯·æ±‚å‚æ•°

| å‚æ•°å   | ç±»å‹       | æ˜¯å¦å¿…å¡« | è¯´æ˜        |
| -------- | ---------- | -------- | ----------- |
| username | `string` | æ˜¯       | æ‰‹æœºå·/å§“å |
| password | `string` | æ˜¯       | å¯†ç         |

#### ç¤ºä¾‹è¯·æ±‚ä½“

```json
{
  "username": "doctor1",
  "password": "password"
}
```

---

### âœ… æˆåŠŸå“åº”ï¼ˆ200 OKï¼‰

```json
{
  "status": 200,
  "data": {
    "id": "101",
    "isAdmin": false,
    "isDoctor": true,
    "isPatient": false,
    "name": "åŒ»ç”Ÿ1",
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJkb2N0b3IxIiwiaWF0IjoxNjA3NzQ5MTYyLCJleHBpcnkiOjE2MDc5MzcwMDB9.zw2QCE-rH1QNGzmmx6Vmg6XYISbFQm9fg2ESyI9gyLQ"
  },
  "message": "ç™»å½•æˆåŠŸ"
}
```

---

### âŒ å¤±è´¥å“åº”ï¼ˆ401 Unauthorizedï¼‰

```json
{
  "status": 401,
  "data": null,
  "message": "ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯"
}
```

### âŒ å¤±è´¥å“åº”ï¼ˆ400 Bad Request ï¼‰

```json
{
  "status": 400,
  "data": null,
  "message": "ç¼ºå°‘ username æˆ– password å‚æ•°"
}
```

### ğŸ“Œ è®¤è¯è¯´æ˜

ç™»å½•æˆåŠŸï¼šæˆåŠŸç™»å½•åï¼Œè¿”å›çš„å“åº”ä¸­ä¼šåŒ…å«ä¸€ä¸ª `token` å­—æ®µï¼Œä¿å­˜äº†ç»è¿‡åŠ å¯†çš„ JWTï¼ˆJSON Web Tokenï¼‰ã€‚è¿™ä¸ªä»¤ç‰Œæ˜¯ç”¨æ¥éªŒè¯åç»­è¯·æ±‚ç”¨æˆ·èº«ä»½çš„ã€‚

è®¤è¯è¿‡ç¨‹ï¼šåç»­æ¯ä¸ªéœ€è¦èº«ä»½éªŒè¯çš„ API è¯·æ±‚ï¼Œéƒ½éœ€è¦åœ¨è¯·æ±‚å¤´ä¸­é™„å¸¦ `Authorization` å­—æ®µï¼Œæ ¼å¼ä¸ºï¼š

```
Authorization: Bearer <token>
```

åç«¯åœ¨æ¥æ”¶åˆ°è¯·æ±‚æ—¶ï¼Œä¼šè§£ç å¹¶éªŒè¯ä»¤ç‰Œï¼Œç¡®ä¿ç”¨æˆ·èº«ä»½åˆæ³•ã€‚å¦‚æœä»¤ç‰Œæ— æ•ˆæˆ–å·²è¿‡æœŸï¼Œå°†è¿”å› `401 Unauthorized` é”™è¯¯ã€‚

### ç™»å½•è¯´æ˜

åŒ»ç”Ÿå’Œæ‚£è€…å¯é€šè¿‡æ‰‹æœºå·æˆ–å§“åç™»å½•ã€‚ç®¡ç†å‘˜è´¦å·éœ€é¢„å…ˆè®¾å®šï¼Œä¸æä¾› API æ³¨å†Œã€‚

---

## ğŸŸ© 2. ç”¨æˆ·æ³¨å†Œ

- **URL**: `/api/users`
- **æ–¹æ³•**: `POST`
- **æè¿°**: ç”¨æˆ·æ³¨å†Œæ¥å£ï¼Œæä¾›å§“åã€ç”µè¯ã€æ€§åˆ«ã€å‡ºç”Ÿæ—¥æœŸå’Œèº«ä»½è¯å·/æŠ¤ç…§ä¿¡æ¯ï¼Œå¯†ç ï¼ŒæˆåŠŸåè¿”å›ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ã€‚

### ğŸ“¥ è¯·æ±‚å‚æ•°

| å‚æ•°å    | ç±»å‹       | æ˜¯å¦å¿…å¡« | è¯´æ˜                    |
| --------- | ---------- | -------- | ----------------------- |
| name      | `string` | æ˜¯       | å§“å                    |
| phone     | `string` | æ˜¯       | ç”µè¯å·ç                 |
| gender    | `string` | æ˜¯       | æ€§åˆ«ï¼ˆå¦‚ "ç”·" æˆ– "å¥³"ï¼‰ |
| birthDate | `string` | æ˜¯       | å‡ºç”Ÿæ—¥æœŸ                |
| idType    | `string` | æ˜¯       | "èº«ä»½è¯" æˆ– "æŠ¤ç…§"      |
| idNumber  | `string` | æ˜¯       | è¯ä»¶å·ç                 |
| password  | `string` | æ˜¯       | å¯†ç                     |

#### ç¤ºä¾‹è¯·æ±‚ä½“ï¼ˆé€‰æ‹©èº«ä»½è¯å·ï¼‰

```json
{
  "name": "æ–°ç”¨æˆ·",
  "phone": "13812345678",
  "gender": "ç”·",
  "birthDate": "1990-01-01",
  "idType": "èº«ä»½è¯",
  "idNumber": "123456789012345678",
  "password": "123"
}
```

#### ç¤ºä¾‹è¯·æ±‚ä½“ï¼ˆé€‰æ‹©æŠ¤ç…§å·ï¼‰

```json
{
  "name": "æ–°ç”¨æˆ·",
  "phone": "13812345678",
  "gender": "ç”·",
  "birthDate": "1990-01-01",
  "idType": "æŠ¤ç…§",
  "idNumber": "p12345678901",
  "password": "123"
}
```

#### æˆåŠŸå“åº”ï¼ˆ201 Createdï¼‰

```json
{
  "status": 201,
  "data": {
    "id": "202",
    "name": "æ–°ç”¨æˆ·",
    "phone": "13812345678",
    "gender": "ç”·",
    "birthDate": "1990-01-01",
    "idType": "èº«ä»½è¯",
    "idNumber": "123456789012345678"
  },
  "message": "æ³¨å†ŒæˆåŠŸ"
}
```

### 422 éªŒè¯é”™è¯¯ï¼ˆ400 Bad Requestï¼‰

```json
{
  "status": 400,
  "data": null,
  "message": "è¯·æ±‚å‚æ•°é”™è¯¯ï¼šç”µè¯å·ç æ ¼å¼ä¸æ­£ç¡®" // ç¤ºä¾‹æ¶ˆæ¯
}
```

### æ‰‹æœºå·å·²å­˜åœ¨ï¼ˆ409 Conflictï¼‰

```json
{
  "status": 409,
  "data": null,
  "message": "æ‰‹æœºå·å·²è¢«æ³¨å†Œ"
}
```

### æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼ˆ500 Internal Server Errorï¼‰

```json
{
  "status": 500,
  "data": null,
  "message": "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œè¯·è”ç³»ç®¡ç†å‘˜"
}
```

---

## ğŸ“Œ çŠ¶æ€ç è¯´æ˜

| çŠ¶æ€ç  | å«ä¹‰                       |
| ------ | -------------------------- |
| 200    | è¯·æ±‚æˆåŠŸ                   |
| 201    | åˆ›å»ºæˆåŠŸ                   |
| 401    | æœªæˆæƒï¼ˆç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼‰ |
| 409    | å†²çªï¼ˆå¦‚ç”¨æˆ·åå·²å­˜åœ¨ï¼‰     |
| 500    | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯             |

# äºŒã€‚åŒ»ç”Ÿä¸æ‚£è€…å…³ç³»ç®¡ç†ç³»ç»Ÿ API æ–‡æ¡£

æœ¬ API æ–‡æ¡£åŸºäº RESTful è§„èŒƒï¼Œæ”¯æŒåŒ»ç”Ÿæ³¨å†Œã€è·å–åŒ»ç”Ÿ/æ‚£è€…ä¿¡æ¯ã€ä»¥åŠåŒ»ç”Ÿ-æ‚£è€…å…³ç³»çš„å¢åˆ æ”¹æŸ¥ã€‚æ‰€æœ‰æ¥å£éœ€è¦ç®¡ç†å‘˜æƒé™

---

## é€šç”¨ä¿¡æ¯

- è¯·æ±‚åœ°å€ç»Ÿä¸€å‰ç¼€ï¼š`/api/admin`
- è¯·æ±‚å¤´ï¼š
  `Content-Type: application/json`
  `Authorization: Bearer <token>`

---

## ğŸ“˜ åŒ»ç”Ÿç®¡ç†

### 1. è·å–åŒ»ç”Ÿåˆ—è¡¨

- **URL**ï¼š`/api/admin/doctors`
- **æ–¹æ³•**ï¼šGET
- **æè¿°**ï¼šè·å–æ‰€æœ‰å·²æ³¨å†Œçš„åŒ»ç”Ÿä¿¡æ¯

#### âœ… å“åº”

```json
{
  "status": 200,
  "data": [
    {
      "id": "1",
      "name": "å¼ ä¸‰",
      "phone": "13800001111",
      "hospital": "åŒ—äº¬åå’ŒåŒ»é™¢",
      "department": "å†…ç§‘"
    },
    {
      "id": "2",
      "name": "æå››",
      "phone": "13800002222",
      "hospital": "ä¸Šæµ·ç‘é‡‘åŒ»é™¢",
      "department": "å¤–ç§‘"
    }
  ],
  "message": "è·å–åŒ»ç”Ÿåˆ—è¡¨æˆåŠŸ"
}
```

### å¤±è´¥å“åº”

// 401 Unauthorized (æœªæä¾›ä»¤ç‰Œæˆ–ä»¤ç‰Œæ— æ•ˆ)

```json
{ "status": 401, "data": null, "message": "æœªæˆæƒè®¿é—®" }
```

// 403 Forbidden (ç”¨æˆ·éç®¡ç†å‘˜)

```json
{ "status": 403, "data": null, "message": "æƒé™ä¸è¶³" }
```

// 500 Internal Server Error

```json
{ "status": 500, "data": null, "message": "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯" }
```

---

- **å­—æ®µè¯´æ˜ï¼š**

| å­—æ®µ       | ç±»å‹   | æè¿°             |
| ---------- | ------ | ---------------- |
| `status` | number | çŠ¶æ€ç ï¼ˆå¦‚ 200ï¼‰ |
| `data`   | array  | åŒ»ç”Ÿä¿¡æ¯æ•°ç»„     |

**data æ•°ç»„å†…å¯¹è±¡å­—æ®µè¯´æ˜ï¼š**

| å­—æ®µ           | ç±»å‹   | æè¿°        |
| -------------- | ------ | ----------- |
| `id`         | string | åŒ»ç”Ÿå”¯ä¸€ ID |
| `name`       | string | å§“å        |
| `phone`      | string | ç”µè¯å·ç     |
| `hospital`   | string | æ‰€åœ¨åŒ»é™¢    |
| `department` | string | ç§‘å®¤        |

---

### ğŸŸ© 2. æ³¨å†Œæ–°åŒ»ç”Ÿ

- **æ¥å£è·¯å¾„**: `/api/admin/doctors`
- **è¯·æ±‚æ–¹æ³•**: `POST`
- **æ¥å£æè¿°**: é€šè¿‡æä¾›å¯†ç ã€å§“åã€æ‰‹æœºå·ã€åŒ»é™¢å’Œç§‘å®¤ä¿¡æ¯æ¥æ³¨å†Œä¸€ä¸ªæ–°çš„åŒ»ç”Ÿè´¦å·ã€‚

#### ğŸ“¥ è¯·æ±‚ä½“

```json
{
  "password": "123456",
  "name": "å¼ ä¸‰",
  "phone": "13812345678",
  "hospital": "Beijing General Hospital",
  "department": "Cardiology"
}
```

#### âœ… Response (æˆåŠŸ)

```json
{
  "status": 201,
  "data": {
    "id": "3",

    "name": "å¼ ä¸‰",
    "phone": "13812345678",
    "hospital": "Beijing General Hospital",
    "department": "Cardiology"
  },
  "message": "åŒ»ç”Ÿæ³¨å†ŒæˆåŠŸ"
}
```

### å¤±è´¥å“åº”

// 401 Unauthorized (æœªæä¾›ä»¤ç‰Œæˆ–ä»¤ç‰Œæ— æ•ˆ)

```json
{ "status": 401, "data": null, "message": "æœªæˆæƒè®¿é—®" }
```

// 403 Forbidden (ç”¨æˆ·éç®¡ç†å‘˜)

```json
{ "status": 403, "data": null, "message": "æƒé™ä¸è¶³" }
```

// 500 Internal Server Error

```json
{ "status": 500, "data": null, "message": "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯" }
```

// 409 Conflict (æ‰‹æœºå·æˆ–å§“åå·²å­˜åœ¨)

```json
{ "status": 409, "data": null, "message": "æ‰‹æœºå·æˆ–å§“åå·²è¢«æ³¨å†Œ" }
```

// 400 Bad Request (å‚æ•°æ ¡éªŒå¤±è´¥)

```json
{ "status": 400, "data": null, "message": "è¯·æ±‚å‚æ•°é”™è¯¯ï¼šç¼ºå°‘å­—æ®µ" }
```

- | **å­—æ®µè¯´æ˜ï¼š** | å­—æ®µ   | ç±»å‹        | æè¿° |
  | -------------------- | ------ | ----------- | ---- |
  | `id`               | string | åŒ»ç”Ÿå”¯ä¸€ ID |      |
  | `name`             | string | åŒ»ç”Ÿå§“å    |      |
  | `phone`            | string | ç”µè¯å·ç     |      |
  | `hospital`         | string | åŒ»é™¢åç§°    |      |
  | `department`       | string | ç§‘å®¤åç§°    |      |

---

---

## ğŸ§â€â™‚ï¸ 3.è·å–æ‚£è€…åˆ—è¡¨

- **URL**ï¼š`/api/admin/patients`
- **æ–¹æ³•**ï¼šGET
- **æè¿°**ï¼šè·å–æ‰€æœ‰æ‚£è€…ä¿¡æ¯

#### âœ… å“åº”

```json
{
  "status": 200,
  "data": [
    {
      "id": "1",
      "name": "ç‹äº”"
    },
    {
      "id": "2",
      "name": "èµµå…­"
    }
  ],
  "message": "è·å–æ‚£è€…åˆ—è¡¨æˆåŠŸ"
}
```

è‹¥æ— æ‚£è€… date è¿”å›ç©ºæ•°ç»„[]

### å¤±è´¥å“åº”

// 401 Unauthorized (æœªæä¾›ä»¤ç‰Œæˆ–ä»¤ç‰Œæ— æ•ˆ)

```json
{ "status": 401, "data": null, "message": "æœªæˆæƒè®¿é—®" }
```

// 403 Forbidden (ç”¨æˆ·éç®¡ç†å‘˜)

```json
{ "status": 403, "data": null, "message": "æƒé™ä¸è¶³" }
```

// 500 Internal Server Error

```json
{ "status": 500, "data": null, "message": "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯" }
```

---

## ğŸ”„ åŒ»ç”Ÿ-æ‚£è€…å…³ç³»ç®¡ç†

### 4.è·å–åŒ»ç”Ÿ-æ‚£è€…å…³ç³»åˆ—è¡¨

- **URL**ï¼š`/api/admin/relations`
- **æ–¹æ³•**ï¼šGET
- **æè¿°**ï¼šè¿”å›æ‰€æœ‰åŒ»ç”Ÿä¸æ‚£è€…ä¹‹é—´çš„å…³è”ä¿¡æ¯

#### âœ… å“åº”

```json
{
  "status": 200,
  "data": [
    {
      "doctorId": "1",
      "doctorName": "å¼ ä¸‰",
      "patientId": "2",
      "patientName": "èµµå…­"
    }
  ],
  "message": "è·å–åŒ»ç”Ÿ-æ‚£è€…å…³ç³»åˆ—è¡¨æˆåŠŸ"
}
```

### å¤±è´¥å“åº”

// 401 Unauthorized (æœªæä¾›ä»¤ç‰Œæˆ–ä»¤ç‰Œæ— æ•ˆ)

```json
{ "status": 401, "data": null, "message": "æœªæˆæƒè®¿é—®" }
```

// 403 Forbidden (ç”¨æˆ·éç®¡ç†å‘˜)

```json
{ "status": 403, "data": null, "message": "æƒé™ä¸è¶³" }
```

// 500 Internal Server Error

```json
{ "status": 500, "data": null, "message": "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯" }
```

---

### 5.æ·»åŠ åŒ»ç”Ÿ-æ‚£è€…å…³ç³»

- **URL**ï¼š`/api/admin/relations`
- **æ–¹æ³•**ï¼šPOST
- **æè¿°**ï¼šæ·»åŠ åŒ»ç”Ÿä¸æ‚£è€…ä¹‹é—´çš„å…³ç³»

#### ğŸ“¥ è¯·æ±‚ä½“

```json
{
  "doctorId": "1",
  "patientId": "2"
}
```

#### âœ… å“åº”

```json
{
  "status": 201,
  "data": {
    "doctorId": "1",
    "patientId": "2"
  },
  "message": "åŒ»ç”Ÿ-æ‚£è€…å…³ç³»æ·»åŠ æˆåŠŸ"
}
```

### å¤±è´¥å“åº”

// 401 Unauthorized (æœªæä¾›ä»¤ç‰Œæˆ–ä»¤ç‰Œæ— æ•ˆ)

```json
{ "status": 401, "data": null, "message": "æœªæˆæƒè®¿é—®" }
```

// 403 Forbidden (ç”¨æˆ·éç®¡ç†å‘˜)

```json
{ "status": 403, "data": null, "message": "æƒé™ä¸è¶³" }
```

// 500 Internal Server Error

```json
{ "status": 500, "data": null, "message": "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯" }
```

// 409 Conflict (å…³ç³»å·²å­˜åœ¨)

```json
{ "status": 409, "data": null, "message": "è¯¥åŒ»æ‚£å…³ç³»å·²å­˜åœ¨" }
```

// 400 Bad Request (å‚æ•°é”™è¯¯æˆ– Doctor/Patient ID ä¸å­˜åœ¨)

```json
{ "status": 400, "data": null, "message": "è¯·æ±‚å‚æ•°é”™è¯¯ï¼šåŒ»ç”Ÿ ID '1' ä¸å­˜åœ¨" }
```

---

### 6.æ›´æ–°åŒ»ç”Ÿ-æ‚£è€…å…³ç³»

- **URL**ï¼š`/api/admin/relations`
- **æ–¹æ³•**ï¼šPUT
- **æè¿°**ï¼šæ›´æ–°å·²æœ‰çš„åŒ»ç”Ÿä¸æ‚£è€…çš„å…³ç³»

#### ğŸ“¥ è¯·æ±‚ä½“

```json
{
  "oldDoctorId": "1",
  "oldPatientId": "2",
  "doctorId": "3",
  "patientId": "4"
}
```

#### âœ… å“åº”

```json
{
  "status": 200,
  "data": {
    "doctorId": "3",
    "patientId": "4"
  },
  "message": "æ›´æ–°åŒ»ç”Ÿ-æ‚£è€…å…³ç³»æˆåŠŸ"
}
```

### å¤±è´¥å“åº”

// 401 Unauthorized (æœªæä¾›ä»¤ç‰Œæˆ–ä»¤ç‰Œæ— æ•ˆ)

```json
{ "status": 401, "data": null, "message": "æœªæˆæƒè®¿é—®" }
```

// 403 Forbidden (ç”¨æˆ·éç®¡ç†å‘˜)

```json
{ "status": 403, "data": null, "message": "æƒé™ä¸è¶³" }
```

// 500 Internal Server Error

```json
{ "status": 500, "data": null, "message": "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯" }
```

// 409 Conflict (å…³ç³»å·²å­˜åœ¨)

```json
{ "status": 409, "data": null, "message": "è¯¥åŒ»æ‚£å…³ç³»å·²å­˜åœ¨" }
```

// 400 Bad Request (å‚æ•°é”™è¯¯æˆ– Doctor/Patient ID ä¸å­˜åœ¨)

```json
{ "status": 400, "data": null, "message": "è¯·æ±‚å‚æ•°é”™è¯¯ï¼šåŒ»ç”Ÿ ID '1' ä¸å­˜åœ¨" }
```

---

### 7.åˆ é™¤åŒ»ç”Ÿ-æ‚£è€…å…³ç³»

- **URL**ï¼š`/api/admin/relations`
- **æè¿°**ï¼šæ ¹æ®å…³ç³» ID åˆ é™¤å¯¹åº”çš„åŒ»ç”Ÿ-æ‚£è€…å…³ç³»
- **æ–¹æ³•**ï¼šDELETE
- #### ğŸ“¥ è¯·æ±‚ä½“

```json
{
  "doctorId": "1",
  "patientId": "2"
}
```

#### âœ… å“åº”ï¼ˆæˆåŠŸï¼‰

```json
{
  "status": 204,
  "data": null,
  "message": "åˆ é™¤åŒ»ç”Ÿ-æ‚£è€…å…³ç³»æˆåŠŸ"
}
```

### å¤±è´¥å“åº”

// 401 Unauthorized (æœªæä¾›ä»¤ç‰Œæˆ–ä»¤ç‰Œæ— æ•ˆ)

```json
{ "status": 401, "data": null, "message": "æœªæˆæƒè®¿é—®" }
```

// 403 Forbidden (ç”¨æˆ·éç®¡ç†å‘˜)

```json
{ "status": 403, "data": null, "message": "æƒé™ä¸è¶³" }
```

// 500 Internal Server Error

```json
{ "status": 500, "data": null, "message": "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯" }
```

// 404 Not Found (æŒ‡å®šçš„ doctorId/patientId å…³ç³»ä¸å­˜åœ¨)

```json
{ "status": 404, "data": null, "message": "æœªæ‰¾åˆ°è¦åˆ é™¤çš„åŒ»æ‚£å…³ç³»" }
```

// 400 Bad Request (å‚æ•°é”™è¯¯æˆ– Doctor/Patient ID ä¸å­˜åœ¨)

```json
{ "status": 400, "data": null, "message": "è¯·æ±‚å‚æ•°é”™è¯¯" }
```

---

## ğŸ“Œ çŠ¶æ€ç è¯´æ˜

| çŠ¶æ€ç  | å«ä¹‰                            |
| ------ | ------------------------------- |
| 200    | è¯·æ±‚æˆåŠŸ                        |
| 201    | åˆ›å»ºæˆåŠŸ                        |
| 204    | åˆ é™¤æˆåŠŸï¼Œæ— å†…å®¹è¿”å›            |
| 400    | é”™è¯¯çš„è¯·æ±‚å‚æ•°                  |
| 401    | æœªæˆæƒè®¿é—®                      |
| 403    | ç¦æ­¢è®¿é—® (Forbidden) - æƒé™ä¸è¶³ |
| 404    | è¯·æ±‚èµ„æºä¸å­˜åœ¨                  |
| 409    | æ•°æ®å†²çªï¼ˆå¦‚ç”¨æˆ·åé‡å¤ï¼‰        |
| 500    | æœåŠ¡å™¨é”™è¯¯                      |

---

# ä¸‰. æ‚£è€…ç®¡ç†ç³»ç»Ÿ RESTful API æ–‡æ¡£

è¯¥æ–‡æ¡£æè¿°äº†æ‚£è€…ç®¡ç†ç³»ç»Ÿä¸­ä½¿ç”¨çš„ RESTful API æ¥å£ï¼ŒåŒ…æ‹¬åŒ»ç”Ÿå…³è”æ‚£è€…çš„è·å–æ¥å£å’Œæ‚£è€…æŠ¥å‘Šæ•°æ®çš„è·å–æ¥å£ã€‚
é€šç”¨ä¿¡æ¯
è®¤è¯è¦æ±‚ï¼š æœ¬æ¨¡å—æ‰€æœ‰æ¥å£å‡éœ€è¦æœ‰æ•ˆçš„ Authorization: Bearer `<token>` è¯·æ±‚å¤´ã€‚å…·ä½“æƒé™è¦æ±‚è§å„æ¥å£è¯´æ˜ã€‚
å“åº”ç»“æ„ï¼š éµå¾ªç»Ÿä¸€ç»“æ„ { status, data, message } ã€‚

---

## æ¥å£æ€»è§ˆ

| æ–¹æ³• | æ¥å£è·¯å¾„                            | æè¿°                       |
| ---- | ----------------------------------- | -------------------------- |
| GET  | `/api/doctor/:doctorId/patients`  | è·å–æŸä½åŒ»ç”Ÿçš„æ‚£è€…åˆ—è¡¨     |
| GET  | `/api/patient/:patientId/reports` | è·å–æŒ‡å®šæ‚£è€…çš„æ­¥æ€æŠ¥å‘Šåˆ—è¡¨ |

---

## 1. è·å–æŸä½åŒ»ç”Ÿçš„æ‚£è€…åˆ—è¡¨

- **æ¥å£è·¯å¾„ï¼š** `/api/doctor/:doctorId/patients`
- **è¯·æ±‚æ–¹æ³•ï¼š** `GET`
- **è¯·æ±‚å‚æ•°ï¼š**

  - `doctorId`ï¼ˆè·¯å¾„å‚æ•°ï¼‰ï¼šåŒ»ç”Ÿçš„å”¯ä¸€æ ‡è¯†ï¼ˆå¦‚ï¼š101ï¼‰(ç±»å‹ï¼šstring)
- **è¯·æ±‚ç¤ºä¾‹ï¼š**

  ```
  GET /api/doctor/101/patients
  ```
- **å“åº”ç¤ºä¾‹ï¼ˆ200 OKï¼‰ï¼š**

```json
{
  "status": 200,

  "data": [
    {
      "id": "1001",
      "name": "å¼ ä¸‰",
      "phone": "13800001111",
      "gender": "ç”·",
      "birthDate": "1980-05-20",
      "idNumber": "110101198005201234"
    },
    {
      "id": "1002",
      "name": "æå››",
      "phone": "13800002222",
      "gender": "å¥³",
      "birthDate": "1992-08-15",
      "idNumber": "110101199208152345"
    },
    {
      "id": "1003",
      "name": "ç‹äº”",
      "phone": "13800003333",
      "gender": "ç”·",
      "birthDate": "1965-12-01",
      "idNumber": "æŠ¤ç…§A12345678"
    }
  ]
  "message": "success",
}
```

---

- **å­—æ®µè¯´æ˜ï¼š**

| å­—æ®µ        | ç±»å‹   | æè¿°             |
| ----------- | ------ | ---------------- |
| `status`  | number | çŠ¶æ€ç ï¼ˆå¦‚ 200ï¼‰ |
| `message` | string | çŠ¶æ€ä¿¡æ¯         |
| `data`    | array  | æ‚£è€…ä¿¡æ¯æ•°ç»„     |

**data æ•°ç»„å†…å¯¹è±¡å­—æ®µè¯´æ˜ï¼š**

| å­—æ®µ          | ç±»å‹   | æè¿°                         |
| ------------- | ------ | ---------------------------- |
| `id`        | string | æ‚£è€…å”¯ä¸€ ID                  |
| `name`      | string | å§“å                         |
| `phone`     | string | ç”µè¯å·ç                      |
| `gender`    | string | æ€§åˆ«ï¼ˆç”·/å¥³ï¼‰                |
| `birthDate` | string | å‡ºç”Ÿæ—¥æœŸï¼ˆæ ¼å¼ï¼šYYYY-MM-DDï¼‰ |
| `idNumber`  | string | èº«ä»½è¯å·æˆ–æŠ¤ç…§å·ç            |

### å¤±è´¥å“åº”

// 401 Unauthorized (æœªæä¾›ä»¤ç‰Œæˆ–ä»¤ç‰Œæ— æ•ˆ)

```json
{ "status": 401, "data": null, "message": "æœªæˆæƒè®¿é—®" }
```

// 403 Forbidden (ç™»å½•ç”¨æˆ·ä¸æ˜¯è¯¥åŒ»ç”Ÿä¸”éç®¡ç†å‘˜)

```json
{ "status": 403, "data": null, "message": "æƒé™ä¸è¶³ï¼Œæ— æ³•æŸ¥çœ‹è¯¥åŒ»ç”Ÿçš„æ‚£è€…åˆ—è¡¨" }
```

// 500 Internal Server Error

```json
{ "status": 500, "data": null, "message": "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯" }
```

// 404 Conflict (åŒ»ç”Ÿ ID ä¸å­˜åœ¨)

```json
{ "status": 404, "data": null, "message": "æœªæ‰¾åˆ°æŒ‡å®šçš„åŒ»ç”Ÿ" }
```

---

## 2. è·å–æŸä½æ‚£è€…çš„æ­¥æ€è¯„ä¼°æŠ¥å‘Š

- **æ¥å£è·¯å¾„ï¼š** `/api/patient/:patientId/reports`
- **è¯·æ±‚æ–¹æ³•ï¼š** `GET`
- **è¯·æ±‚å‚æ•°ï¼š**

  - `patientId`ï¼ˆè·¯å¾„å‚æ•°ï¼‰ï¼šæ‚£è€…çš„å”¯ä¸€æ ‡è¯†ï¼ˆå¦‚ï¼š1001ï¼‰(ç±»å‹ï¼šstring)
- **è¯·æ±‚ç¤ºä¾‹ï¼š**

  ```
  GET /api/patient/1001/reports
  ```
- **å“åº”ç¤ºä¾‹ï¼ˆ200 OKï¼‰ï¼š**

```json
{
  "status": 200,
  "data": [
    {
      "date": "2025-04-22",
      "type": "æœ€æ–°è¯„ä¼°",
      "summary": "æœ€æ–°æ­¥æ€è¯„ä¼°ï¼Œå„é¡¹æŒ‡æ ‡ç¨³å®šã€‚",
      "reportData": {
        "è¿åŠ¨å¹…åº¦": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12],
        "å¾—åˆ†": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
      }
    },
    {
      "date": "2025-04-18",
      "type": "ä¸­æœŸå¤æŸ¥",
      "summary": "ä¸­æœŸå¤æŸ¥ï¼Œå·¦è…¿æ´»åŠ¨åº¦æœ‰æ‰€æ”¹å–„ã€‚",
      "reportData": {
        "è¿åŠ¨å¹…åº¦": [10, 9, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
        "å¾—åˆ†": [100, 100, 1, 0, 100, 1, 2, 3, 5, 9, 13, 66]
      }
    }
  ],
  "message": "æŸ¥è¯¢æˆåŠŸ"
}
//å¦‚æœè¯¥æ‚£è€…æ— æŠ¥å‘Šï¼ŒreportData ä¸ºç©ºæ•°ç»„ []
```

- **å­—æ®µè¯´æ˜ï¼š**

| å­—æ®µ        | ç±»å‹   | æè¿°             |
| ----------- | ------ | ---------------- |
| `status`  | number | çŠ¶æ€ç ï¼ˆå¦‚ 200ï¼‰ |
| `message` | string | çŠ¶æ€ä¿¡æ¯         |
| `data`    | array  | æ‚£è€…ä¿¡æ¯æ•°ç»„     |

**data æ•°ç»„å†…å¯¹è±¡å­—æ®µè¯´æ˜ï¼š**

| å­—æ®µ           | ç±»å‹   | æè¿°                     |
| -------------- | ------ | ------------------------ |
| `date`       | string | æŠ¥å‘Šæ—¥æœŸï¼ˆYYYY-MM-DDï¼‰   |
| `type`       | string | æŠ¥å‘Šç±»å‹ï¼ˆå¦‚åˆæ­¥è¯„ä¼°ï¼‰   |
| `summary`    | string | æŠ¥å‘Šæ‘˜è¦æè¿°             |
| `reportData` | object | æŠ¥å‘Šæ•°æ®ï¼ˆåŒ…å«æŒ‡æ ‡æ•°ç»„ï¼‰ |

    -`è¿åŠ¨å¹…åº¦`ï¼š`number[]`ï¼Œ12é¡¹æŒ‡æ ‡
    - `å¾—åˆ†`ï¼š`number[]`ï¼Œ12é¡¹åˆ†æ•°

- **æ’åºè¯´æ˜ï¼š**
  - æ¥å£é»˜è®¤æŒ‰ `date` å­—æ®µé™åºæ’åºï¼ˆæœ€æ–°åœ¨å‰ï¼‰

### å¤±è´¥å“åº”

// 401 Unauthorized (æœªæä¾›ä»¤ç‰Œæˆ–ä»¤ç‰Œæ— æ•ˆ)

```json
{ "status": 401, "data": null, "message": "æœªæˆæƒè®¿é—®" }
```

// 403 Forbidden (ç™»å½•ç”¨æˆ·éè¯¥æ‚£è€…å…³è”åŒ»ç”Ÿä¸”éç®¡ç†å‘˜)

```json
{ "status": 403, "data": null, "message": "æƒé™ä¸è¶³ï¼Œæ— æ³•æŸ¥çœ‹è¯¥æ‚£è€…çš„æŠ¥å‘Š" }
```

// 500 Internal Server Error

```json
{ "status": 500, "data": null, "message": "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯" }
```

// 404 Conflict (æ‚£è€… ID ä¸å­˜åœ¨)

```json
{ "status": 404, "data": null, "message": "æœªæ‰¾åˆ°æŒ‡å®šçš„æ‚£è€…" }
```

---

---

# å››. CSV æ•°æ®ä¸Šä¼ æ¥å£æ–‡æ¡£

æœ¬èŠ‚æ–‡æ¡£æè¿°äº†æ‚£è€…ç®¡ç†ç³»ç»Ÿä¸­ç”¨äºä¸Šä¼  IMU æ•°æ® CSV æ–‡ä»¶çš„ RESTful API æ¥å£ï¼Œéµå¾ª RESTful API è®¾è®¡è§„èŒƒã€‚

---

## æ¥å£æ€»è§ˆ

| æ–¹æ³• | æ¥å£è·¯å¾„            | æè¿°                   |
| ---- | ------------------- | ---------------------- |
| POST | `/api/upload/csv` | ä¸Šä¼  IMU æ•°æ® CSV æ–‡ä»¶ |

---

## 1. ä¸Šä¼  IMU æ•°æ® CSV æ–‡ä»¶

- **æ¥å£è·¯å¾„ï¼š** `/api/upload/csv`
- **è¯·æ±‚æ–¹æ³•ï¼š** `POST`
- **è¯·æ±‚ç±»å‹ï¼š** `multipart/form-data`
- **æè¿°ï¼š**
  å‘åç«¯ä¸Šä¼ é‡‡é›†åˆ°çš„ IMU æ•°æ® CSV æ–‡ä»¶ï¼ŒåŒæ—¶é™„å¸¦æ‚£è€… ID ä¿¡æ¯ã€‚åç«¯å°†ä¿å­˜å¹¶è§£ææ•°æ®ã€‚
- **è¯·æ±‚å‚æ•°ï¼š**

| å‚æ•°å    | ç±»å‹   | æ˜¯å¦å¿…é¡» | æè¿°                     |
| --------- | ------ | -------- | ------------------------ |
| file      | File   | æ˜¯       | CSV æ–‡ä»¶å†…å®¹ï¼ˆIMU æ•°æ®ï¼‰ |
| patientId | string | æ˜¯       | æ‚£è€…çš„å”¯ä¸€æ ‡è¯†           |

- **è¯·æ±‚ç¤ºä¾‹ï¼š**

```http
POST /api/upload/csv HTTP/1.1
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary

------WebKitFormBoundary
Content-Disposition: form-data; name="file"; filename="imu_data_2025-04-24.csv"
Content-Type: text/csv

æ—¶é—´æˆ³,è®¾å¤‡ID,è®¾å¤‡åç§°,AccX(g),AccY(g),AccZ(g),GyroX(Â°/s),GyroY(Â°/s),GyroZ(Â°/s),Roll(Â°),Pitch(Â°),Yaw(Â°)
"2025-04-24T10:00:00",001,"IMU_A",0.01,0.02,0.98,0.1,0.1,0.2,10.0,5.0,0.0

------WebKitFormBoundary
Content-Disposition: form-data; name="patientId"

1001
------WebKitFormBoundary--
```

- **å“åº”ç¤ºä¾‹ï¼ˆ200 OKï¼‰ï¼š**

```json
{
  "status": 200,

  "data": {
    "receivedAt": "2025-04-24T10:30:00.123Z"
  },
  "message": "CSV æ–‡ä»¶ä¸Šä¼ æˆåŠŸ"
}
```

- **å“åº”å­—æ®µè¯´æ˜ï¼š**

| å­—æ®µå         | ç±»å‹   | æè¿°                               |
| -------------- | ------ | ---------------------------------- |
| status         | number | çŠ¶æ€ç ï¼Œ200 è¡¨ç¤ºæˆåŠŸ               |
| message        | string | å“åº”ä¿¡æ¯                           |
| data           | object | è¿”å›çš„é™„åŠ æ•°æ®                     |
| â””â”€receivedAt | string | åç«¯æ¥æ”¶åˆ°è¯·æ±‚çš„æ—¶é—´æˆ³ï¼ˆISO æ ¼å¼ï¼‰ |

- **é”™è¯¯å“åº”ç¤ºä¾‹ï¼ˆ400 Bad Requestï¼‰ï¼š**

// 400 Bad Request (ç¼ºå°‘å‚æ•°ã€æ–‡ä»¶æ ¼å¼é”™è¯¯ã€æ–‡ä»¶è¿‡å¤§ã€CSV å†…å®¹ä¸ç¬¦åˆè¦æ±‚ã€Patient ID ä¸å­˜åœ¨ç­‰)

```json
{ "status": 400, "data": null, "message": "è¯·æ±‚é”™è¯¯ï¼šç¼ºå°‘å¿…éœ€çš„ patientId å‚æ•°" }
{ "status": 400, "data": null, "message": "è¯·æ±‚é”™è¯¯ï¼šæ–‡ä»¶ç±»å‹å¿…é¡»ä¸º CSV" }
{ "status": 400, "data": null, "message": "è¯·æ±‚é”™è¯¯ï¼šCSV æ–‡ä»¶ç¼ºå°‘å¿…éœ€çš„ 'æ—¶é—´æˆ³' åˆ—" }
```

// 401 Unauthorized (æœªç™»å½•æˆ–ä»¤ç‰Œæ— æ•ˆ)

```json
{ "status": 401, "data": null, "message": "æœªæˆæƒè®¿é—®" }
```

// 403 Forbidden (æ— æƒä¸ºè¯¥æ‚£è€…ä¸Šä¼ æ•°æ®)

```json
{ "status": 403, "data": null, "message": "æƒé™ä¸è¶³ï¼Œæ— æ³•ä¸ºè¯¥æ‚£è€…ä¸Šä¼ æ•°æ®" }
```

// 500 Internal Server Error (æœåŠ¡å™¨å¤„ç†æ–‡ä»¶å‡ºé”™)

```json
{ "status": 500, "data": null, "message": "æœåŠ¡å™¨å¤„ç† CSV æ–‡ä»¶æ—¶å‡ºé”™" }
```

---

## æ¥å£çº¦æŸè¯´æ˜

- æ–‡ä»¶å¿…é¡»ä¸º `.csv` æ ¼å¼ã€‚
- å¿…é¡»æä¾› `patientId`ï¼Œå¦åˆ™ä¸Šä¼ å¤±è´¥ã€‚
- ä¸Šä¼ å†…å®¹å¿…é¡»åŒ…å«è‡³å°‘ä¸€è¡Œæ•°æ®ï¼ˆä¸åŒ…æ‹¬è¡¨å¤´ï¼‰ã€‚
- Patient ID æ ¡éªŒï¼š åç«¯åº”æ ¡éªŒ patientId æ˜¯å¦æœ‰æ•ˆå­˜åœ¨ã€‚

---

## æ‹¦æˆªå™¨è°ƒè¯•è¯´æ˜ï¼ˆå‰ç«¯å¼€å‘ç”¨ï¼‰

å½“å‰ç³»ç»Ÿå®ç°äº† `window.fetch` çš„æ‹¦æˆªå™¨ç”¨äºå‰ç«¯æ¨¡æ‹Ÿæµ‹è¯•ï¼š

- æ‹¦æˆª `POST /api/upload/csv` è¯·æ±‚ï¼Œå¹¶è¿”å›æ¨¡æ‹Ÿçš„ 200 æˆåŠŸå“åº”ã€‚
- æ¨¡æ‹Ÿå“åº”æ•°æ®æ ¼å¼å¦‚ä¸‹ï¼š

```json
{
  "status": 200,
  "data": {
    "receivedAt": "2025-04-24T10:00:00.000Z"
  },
  "message": "æ¨¡æ‹Ÿï¼šCSV æ–‡ä»¶ä¸Šä¼ æˆåŠŸ (Fetch Interceptor)"
}
```

ç”¨äºå‰ç«¯è°ƒè¯•æ—¶æ— é¡»åç«¯çœŸå®æœåŠ¡ï¼Œå¯ç›´æ¥éªŒè¯ä¸Šä¼ é€»è¾‘å’Œç”¨æˆ·æç¤ºã€‚

# äº”.é™„åŠ è¯´æ˜

- æ‰€æœ‰æ¥å£è¿”å›çš„æ—¶é—´æ ¼å¼ç»Ÿä¸€ä¸º `YYYY-MM-DD`
- æ‰€æœ‰æ•°å€¼å‡ä¸ºæ¨¡æ‹Ÿæ•°æ®ï¼Œä»…ä¾›æµ‹è¯•ä½¿ç”¨
- API æ”¯æŒé€šè¿‡ [Mock.js](https://github.com/nuysoft/Mock) è¿›è¡Œæœ¬åœ°æ¨¡æ‹Ÿæµ‹è¯•
- è‹¥å¯¹æŸä¸ªæ¥å£å“åº”ç»“æ„å­˜åœ¨ç–‘é—®ï¼Œå»ºè®®ä½¿ç”¨è°ƒè¯•å·¥å…·å¦‚ Postmanã€curl æµ‹è¯•
